<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="679px" preserveAspectRatio="none" style="width:861px;height:679px;background:#FFFFFF;" version="1.1" viewBox="0 0 861 679" width="861px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="715" x="71.5" y="15"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="705" x="76.5" y="32.9951">Broker de Eventos Caipora - Fluxo funcionamento de distribuição de eventos pelo broker</text><ellipse cx="459.75" cy="57.2969" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><rect fill="#F1F1F1" height="47.9375" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="377.75" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="138" x="387.75" y="108.4355">Recebe solicitação de</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="391.75" y="122.4043">evento do consumidor</text><polygon fill="#F1F1F1" points="380.75,205.2461,538.75,205.2461,550.75,218.0508,538.75,230.8555,380.75,230.8555,368.75,218.0508,380.75,205.2461" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="146" x="380.75" y="215.4565">Tem evento disponivel no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="384.75" y="228.2612">tópico desse consumidor ?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="347.75" y="215.4565">sim</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="550.75" y="215.4565">não</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="250" x="192" y="240.8555"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="230" x="202" y="261.9941">Seleciona evento para o consumidor</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="214" x="210" y="294.8242"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="194" x="220" y="315.9629">Retorna evento ao consumidor</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="281" x="462" y="240.8555"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="261" x="472" y="261.9941">Comunica consumidor que não há evento</text><polygon fill="#F1F1F1" points="459.75,334.793,471.75,346.793,459.75,358.793,447.75,346.793,459.75,334.793" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="459.75" cy="389.793" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="459.75" cy="389.793" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><polygon fill="#F1F1F1" points="388.75,155.2344,530.75,155.2344,542.75,168.0391,530.75,180.8438,388.75,180.8438,376.75,168.0391,388.75,155.2344" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="463.75" y="191.0542">sim</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="129" x="388.75" y="165.4448">Solicitação vem de um</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="138" x="392.75" y="178.2495">consumidor conhecido ?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="542.75" y="165.4448">não</text><ellipse cx="583.75" cy="168.0391" fill="#F1F1F1" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;"/><path d="M582.0469,171.2891 L586.1875,171.2891 L586.1875,172.2891 L580.625,172.2891 L580.625,171.2891 Q581.2969,170.6016 582.4531,169.4297 Q583.625,168.2422 583.9219,167.8984 Q584.5,167.2734 584.7188,166.8359 Q584.9531,166.3828 584.9531,165.9609 Q584.9531,165.2578 584.4531,164.8203 Q583.9688,164.3828 583.1875,164.3828 Q582.625,164.3828 582,164.5703 Q581.3906,164.7578 580.6875,165.1641 L580.6875,163.9609 Q581.4063,163.6797 582.0156,163.5391 Q582.6406,163.3828 583.1563,163.3828 Q584.5156,163.3828 585.3281,164.0703 Q586.1406,164.7422 586.1406,165.8828 Q586.1406,166.4141 585.9375,166.8984 Q585.7344,167.3828 585.2031,168.0391 Q585.0469,168.2109 584.2656,169.0234 Q583.4844,169.8359 582.0469,171.2891 Z " fill="#000000"/><ellipse cx="459.75" cy="420.793" fill="#F1F1F1" rx="10" ry="10" style="stroke:#181818;stroke-width:0.5;"/><path d="M458.0469,424.043 L462.1875,424.043 L462.1875,425.043 L456.625,425.043 L456.625,424.043 Q457.2969,423.3555 458.4531,422.1836 Q459.625,420.9961 459.9219,420.6523 Q460.5,420.0273 460.7188,419.5898 Q460.9531,419.1367 460.9531,418.7148 Q460.9531,418.0117 460.4531,417.5742 Q459.9688,417.1367 459.1875,417.1367 Q458.625,417.1367 458,417.3242 Q457.3906,417.5117 456.6875,417.918 L456.6875,416.7148 Q457.4063,416.4336 458.0156,416.293 Q458.6406,416.1367 459.1563,416.1367 Q460.5156,416.1367 461.3281,416.8242 Q462.1406,417.4961 462.1406,418.6367 Q462.1406,419.168 461.9375,419.6523 Q461.7344,420.1367 461.2031,420.793 Q461.0469,420.9648 460.2656,421.7773 Q459.4844,422.5898 458.0469,424.043 Z " fill="#000000"/><polygon fill="#F1F1F1" points="334.25,450.793,585.25,450.793,597.25,462.793,585.25,474.793,334.25,474.793,322.25,462.793,334.25,450.793" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="243" x="334.25" y="466.6011">Consumidor atual da requisição é o lider ?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="301.25" y="460.1987">sim</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="21" x="597.25" y="460.1987">não</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="468" x="11" y="484.793"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="448" x="21" y="505.9316">Bloqueia a estrutura para balanceamento para todos os consumidores</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="302" x="94" y="538.7617"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="282" x="104" y="559.9004">Verifica todos os clientes ativos no momento</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="404" x="43" y="592.7305"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="384" x="53" y="613.8691">Balanceia a estrutura de particões com esses clientes ativos</text><ellipse cx="245" cy="657.6992" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="245" cy="657.6992" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="351" x="499" y="484.793"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="331" x="509" y="505.9316">Retorna mensagem de estrutura em balanceamento</text><ellipse cx="674.5" cy="549.7617" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="674.5" cy="549.7617" fill="#222222" rx="6" ry="6" style="stroke:#111111;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="459.75" x2="459.75" y1="67.2969" y2="87.2969"/><polygon fill="#181818" points="455.75,77.2969,459.75,87.2969,463.75,77.2969,459.75,81.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="317" x2="317" y1="274.8242" y2="294.8242"/><polygon fill="#181818" points="313,284.8242,317,294.8242,321,284.8242,317,288.8242" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="368.75" x2="317" y1="218.0508" y2="218.0508"/><line style="stroke:#181818;stroke-width:1.0;" x1="317" x2="317" y1="218.0508" y2="240.8555"/><polygon fill="#181818" points="313,230.8555,317,240.8555,321,230.8555,317,234.8555" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="550.75" x2="602.5" y1="218.0508" y2="218.0508"/><line style="stroke:#181818;stroke-width:1.0;" x1="602.5" x2="602.5" y1="218.0508" y2="240.8555"/><polygon fill="#181818" points="598.5,230.8555,602.5,240.8555,606.5,230.8555,602.5,234.8555" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="317" x2="317" y1="328.793" y2="346.793"/><line style="stroke:#181818;stroke-width:1.0;" x1="317" x2="447.75" y1="346.793" y2="346.793"/><polygon fill="#181818" points="437.75,342.793,447.75,346.793,437.75,350.793,441.75,346.793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="602.5" x2="602.5" y1="274.8242" y2="346.793"/><line style="stroke:#181818;stroke-width:1.0;" x1="602.5" x2="471.75" y1="346.793" y2="346.793"/><polygon fill="#181818" points="481.75,342.793,471.75,346.793,481.75,350.793,477.75,346.793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="459.75" x2="459.75" y1="358.793" y2="378.793"/><polygon fill="#181818" points="455.75,368.793,459.75,378.793,463.75,368.793,459.75,372.793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="459.75" x2="459.75" y1="180.8438" y2="205.2461"/><polygon fill="#181818" points="455.75,195.2461,459.75,205.2461,463.75,195.2461,459.75,199.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="542.75" x2="573.75" y1="168.0391" y2="168.0391"/><polygon fill="#181818" points="563.75,164.0391,573.75,168.0391,563.75,172.0391,567.75,168.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="459.75" x2="459.75" y1="135.2344" y2="155.2344"/><polygon fill="#181818" points="455.75,145.2344,459.75,155.2344,463.75,145.2344,459.75,149.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="245" x2="245" y1="518.7617" y2="538.7617"/><polygon fill="#181818" points="241,528.7617,245,538.7617,249,528.7617,245,532.7617" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="245" x2="245" y1="572.7305" y2="592.7305"/><polygon fill="#181818" points="241,582.7305,245,592.7305,249,582.7305,245,586.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="245" x2="245" y1="626.6992" y2="646.6992"/><polygon fill="#181818" points="241,636.6992,245,646.6992,249,636.6992,245,640.6992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="674.5" x2="674.5" y1="518.7617" y2="538.7617"/><polygon fill="#181818" points="670.5,528.7617,674.5,538.7617,678.5,528.7617,674.5,532.7617" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="322.25" x2="245" y1="462.793" y2="462.793"/><line style="stroke:#181818;stroke-width:1.0;" x1="245" x2="245" y1="462.793" y2="484.793"/><polygon fill="#181818" points="241,474.793,245,484.793,249,474.793,245,478.793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="597.25" x2="674.5" y1="462.793" y2="462.793"/><line style="stroke:#181818;stroke-width:1.0;" x1="674.5" x2="674.5" y1="462.793" y2="484.793"/><polygon fill="#181818" points="670.5,474.793,674.5,484.793,678.5,474.793,674.5,478.793" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="459.75" x2="459.75" y1="430.793" y2="450.793"/><polygon fill="#181818" points="455.75,440.793,459.75,450.793,463.75,440.793,459.75,444.793" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[edc7d1988a938a7c0eefdf42921f5cf1]
@startuml
title Broker de Eventos Caipora - Fluxo funcionamento de distribuição de eventos pelo broker

start

:Recebe solicitação de\n evento do consumidor;
if (Solicitação vem de um\n consumidor conhecido ?) then (sim) 
  if (Tem evento disponivel no\n tópico desse consumidor ?) then (sim)
    :Seleciona evento para o consumidor;
    :Retorna evento ao consumidor;
    
  else (não)
    :Comunica consumidor que não há evento; 
  endif
  stop
else (não)
(2)
detach

endif

(2)
if (Consumidor atual da requisição é o lider ?  ) then (sim)
  :Bloqueia a estrutura para balanceamento para todos os consumidores;
  :Verifica todos os clientes ativos no momento;
  :Balanceia a estrutura de particões com esses clientes ativos;
  stop
else (não)
  :Retorna mensagem de estrutura em balanceamento;
  stop
endif
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>